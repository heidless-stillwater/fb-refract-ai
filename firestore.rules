/**
 * @fileoverview Firestore Security Rules for Refract AI (AI Image Hub).
 *
 * Core Philosophy:
 * This ruleset provides public read and write access to transformed image data,
 * as all users are anonymous. Security measures focus on preventing abuse
 * rather than enforcing user-based authorization. Data validation beyond
 * authorization is not performed in this prototyping phase.
 *
 * Data Structure:
 * Transformed images are stored in a top-level collection called
 * `/transformedImages/{transformedImageId}`.
 *
 * Key Security Decisions:
 * - Public read access is granted to all `transformedImages`.
 * - Write access (create, update, delete) is open, but in a real application,
 *   it is critical to add rules to prevent abuse.
 *
 * WARNING: This ruleset does NOT provide adequate protection against abuse.
 *          It MUST be extended with rate limiting, input validation, and
 *          potentially CAPTCHA or similar mechanisms before being deployed
 *          to a production environment.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to transformed image data.
     * @path /transformedImages/{transformedImageId}
     * @allow (get, list) User can retrieve or list transformed images.
     * @deny (create, update, delete) N/A - all users can create, update, and delete images.
     * @principle Allows open access to image data.
     */
    match /transformedImages/{transformedImageId} {
      allow get, list: if true;
      allow create, update, delete: if true; // WARNING: Open write access! Add abuse prevention measures.
    }
  }
}