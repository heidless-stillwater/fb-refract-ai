{
  "entities": {
    "ImageRecord": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ImageRecord",
      "type": "object",
      "description": "Represents a record of an original and transformed image pair.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID of the user who performed the transformation."
        },
        "originalImageUrl": {
          "type": "string",
          "description": "URL of the original image uploaded by the user.",
          "format": "uri"
        },
        "transformedImageUrl": {
          "type": "string",
          "description": "URL of the transformed image.",
          "format": "uri"
        },
        "originalFileName": {
          "type": "string",
          "description": "The original file name of the uploaded image."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp indicating when the record was created.",
          "format": "date-time"
        }
      },
      "required": [
        "userId",
        "originalImageUrl",
        "transformedImageUrl",
        "originalFileName",
        "timestamp"
      ]
    },
    "TransformedImage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TransformedImage",
      "type": "object",
      "description": "Represents a transformed image generated by the AI Image Hub.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transformed image."
        },
        "originalImageURL": {
          "type": "string",
          "description": "URL of the original image uploaded by the user.",
          "format": "uri"
        },
        "transformedImageURL": {
          "type": "string",
          "description": "URL of the transformed image stored in Firebase Storage.",
          "format": "uri"
        },
        "transformationType": {
          "type": "string",
          "description": "The type of AI transformation applied to the image (e.g., style transfer, background removal)."
        },
        "transformationParameters": {
          "type": "string",
          "description": "Additional parameters used for the transformation. Stored as a JSON string.",
          "format": "json-string"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the transformation was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "originalImageURL",
        "transformedImageURL",
        "transformationType",
        "createdAt"
      ]
    },
    "ContactMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactMessage",
      "type": "object",
      "description": "Represents a message submitted through the contact form.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the person submitting the message."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The email address of the person."
        },
        "message": {
          "type": "string",
          "description": "The content of the message."
        },
        "submittedAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the message was submitted."
        },
        "attachmentURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the file attached to the message."
        },
        "attachmentFilename": {
           "type": "string",
           "description": "The original filename of the attachment."
        }
      },
      "required": ["name", "email", "message", "submittedAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/imageRecords/{imageRecordId}",
        "definition": {
          "entityName": "ImageRecord",
          "schema": {
            "$ref": "#/entities/ImageRecord"
          },
          "description": "Stores records of image transformations.",
          "params": [
            {
              "name": "imageRecordId",
              "description": "Unique identifier for the image record."
            }
          ]
        }
      },
      {
        "path": "/transformedImages/{transformedImageId}",
        "definition": {
          "entityName": "TransformedImage",
          "schema": {
            "$ref": "#/entities/TransformedImage"
          },
          "description": "Stores transformed images generated by the AI Image Hub. Includes the original image URL, the transformed image URL, transformation type, parameters and timestamp.",
          "params": [
            {
              "name": "transformedImageId",
              "description": "Unique identifier for the transformed image."
            }
          ]
        }
      },
      {
        "path": "/dnd_contactMessages/{contactMessageId}",
        "definition": {
          "entityName": "ContactMessage",
          "schema": {
            "$ref": "#/entities/ContactMessage"
          },
          "description": "Stores messages submitted through the contact form.",
          "params": [
            {
              "name": "contactMessageId",
              "description": "Unique identifier for the contact message."
            }
          ]
        }
      }
    ],
    "reasoning": "Given the anonymous authentication and the core features of the \"AI Image Hub\" application (Refract AI), the Firestore data structure is designed for simplicity and scalability, focusing on storing transformed images generated by users.  Since there is no authentication, images are stored without explicit user association.\n\nAuthorization Independence is achieved because there are no user-based or role-based access controls. Since users are anonymous, all access is public and determined by rules that prevent abuse and ensure data integrity.  The structure supports the required QAPs because the design is simple. Data is segregated by type and has no complex access rules.\n\nTo ensure security and prevent abuse, security rules should focus on rate limiting and basic input validation (e.g., maximum image size, allowed transformation types)."
  }
}
